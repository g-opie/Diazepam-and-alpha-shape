# Diazepam-and-alpha-shape
This repository contains the code needed to run analyses and generate figures for the following publication:

_Opie GM,  Schaworonkow N, Gordon PC, Humaidan D & Ziemann U (2025) Diazepam alters the shape of alpha oscillations recorded from human cortex using EEG. bioRxiv, DOI: https://doi.org/10.1101/2025.10.24.684311_

This project exmained how the shape of alphs oscillations, recorded non-invasively in humans with electroencephalography (EEG), are modulated following pharmacological potentiation of cortical inhibition involving GABA<sub>A</sub> receptors.

## Data
Due to ethical restrictions, data used in this puplication cannot be shared.

## Analysis
Following minimal prepcrosessing, high SNR alpha activity was extracted using spatio-spectral decomposition (SSD; https://doi.org/10.1016/j.neuroimage.2011.01.057). Cortical locations of identified components was then derived using template matching, prior to waveform analysis with empirical mode decompositions (EMD), and shape quantification with principal component analysis (according to a previously published pipeline; https://doi.org/10.1152/jn.00201.2021). Principal component scores were then compared across _Pre_ and _Post_ time points for the _Placebo_ and _Diazepam_ conditions.

Scripts should be run according to their title prefix in the following order:
- `preprocessing.py`
- `spect_*.py`
- `ssd_*.py`
- `emd_*.py`
- `pca_run.py`

The main statistical analysis using Bayesian generalized linear mixed models can then be run using scripts in the `code/stats/` folders. Secondary analyses involving dsitributional statistics are run when creating the relevant figures.

## Figures
All figures (other than the methods figure [Fig 1]) can be generated by running `Fig_*.py` scripts.
